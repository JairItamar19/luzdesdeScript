<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>luz</title>
</head>

<body>

    <button class="switch">On / Off</button>
    <h2>
        Console output
    </h2>
    <div id="console">

    </div>

    <script>
        const consoleOutput = document.getElementById("console");
        const log = function (msg) {
            consoleOutput.innerText = `${consoleOutput.innerText}\n${msg}`;
            console.log(msg);
        }

        //Test browser support
        const SUPPORTS_MEDIA_DEVICES = 'mediaDevices' in navigator;

        function encender() {
            if (SUPPORTS_MEDIA_DEVICES) {
                //Get the environment camera (usually the second one)
                navigator.mediaDevices.enumerateDevices().then(devices => {

                    const cameras = devices.filter((device) => device.kind === 'videoinput');

                    if (cameras.length === 0) {
                        log('No camera found on this device.');
                    }
                    // Create stream and get video track
                    navigator.mediaDevices.getUserMedia({
                        video: {
                            facingMode: 'environment',
                        }
                    }).then(stream => {
                        const track = stream.getVideoTracks()[0];
                        track.applyConstraints({
                            advanced: [{
                                fillLightMode: true
                            }]
                        });


                    }).catch(log);
                }).catch(log);

                //The light will be on as long the track exists
            }
        }

        encender();
    </script>
</body>

</html>